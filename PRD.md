# Picky Passenger 产品需求文档 (PRD)

## 1. 项目概况
- **项目名称**: Picky Passenger (挑剔乘客)
- **目标平台**: iOS, Android
- **技术栈**: Flutter (基于 Dart)
- **核心定位**: 为自动驾驶产品经理 (PM) 和工程师设计的行驶舒适度量化工具。

## 2. 核心功能需求

### 2.1 传感器引擎 & 校准
- **高频采集**: 100Hz 传感器数据采集（加速度计、陀螺仪）。
- **静态重力校准 (Gravity Alignment)**: 
  - 在车辆静止时，通过算法识别手机摆放角度。
  - 建立旋转矩阵，将手机局部坐标系转换为车辆坐标系（纵向、横向、垂向）。
- **实时监控**:
  - **G-Force 球**: 可视化实时合力方向。
  - **6轴示波器**: 实时展示纵向 ($a_x$) 和横向 ($a_y$) 的加速度波形及角速度。

### 2.2 行程记录与地图
- **轨迹记录**: 实时记录 GPS 轨迹。
- **坐标修正**: 自动完成 WGS-84 到 GCJ-02 (火星坐标系) 的转换，确保中国境内地图匹配精准。
- **地图展示**: 实时描绘行驶路径及负体验事件点。

### 2.3 负体验事件记录 (核心逻辑)
- **自动检测模式**: 基于预设 G 值阈值自动识别急加减速、颠簸、摆动。
- **回溯式手动校准模式 (Retroactive Tagging)**:
  - **15秒循环缓冲区**: 系统始终保存过去 15 秒的传感器原始数据。
  - **记录机制**: 用户感知到不适点击按钮时，系统截取“点击前 10 秒 + 点击后 5 秒”的数据。
  - **真值标定**: 该模式用于收集用户的主观感受，以便后续迭代自动检测算法。
- **事件类型**: 急加速、急减速、颠簸 (Bump)、横向摆动 (Wobble)。

### 2.4 数据管理
- **行程历史**: 本地存储行程，包含轨迹、事件统计及详情。
- **JSON 导出**: 导出包含元数据、轨迹流、事件原始传感器片段的结构化 JSON。

## 3. 视觉与交互设计 (顶级审美)
- **风格**: Sophisticated Minimalism / Neo-Digitalism。
- **配色**: 深色模式 (Dark Mode)，使用荧光绿 (平顺)、警示红 (负体验) 等高对比度色彩。
- **交互**: 
  - 大尺寸交互按钮（适合车内操作）。
  - 全方位的触觉反馈 (Haptic Feedback)。
  - 毛玻璃 (Glassmorphism) UI 元素。

## 4. 国际化 (i18n)
- 支持 **简体中文** 和 **英文**。

